{% extends "base.html" %}
{% block title %}Citizen Dashboard{% endblock %}

{% block content %}
<style>
body {
    background: linear-gradient(180deg, #f4f7fb, #eef2f7);
}

/* MAIN CARD */
.card {
    background: #ffffff;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
}

/* INFO SECTIONS */
.info-box {
    background: #f8f9fd;
    border-left: 5px solid #0d6efd;
    padding: 16px 18px;
    border-radius: 8px;
    margin-bottom: 22px;
    font-size: 14px;
}

.info-box h4 {
    margin: 0 0 8px 0;
    font-size: 15px;
    color: #0d6efd;
}

/* FORM */
input, textarea {
    width: 100%;
    padding: 12px;
    border-radius: 6px;
    border: 1px solid #ccc;
    margin-bottom: 12px;
}

button {
    background: linear-gradient(135deg, #0d6efd, #0a58ca);
    color: white;
    border: none;
    padding: 12px;
    width: 100%;
    border-radius: 6px;
    font-size: 16px;
    cursor: pointer;
}

button:hover {
    box-shadow: 0 6px 14px rgba(13,110,253,0.3);
    transform: translateY(-1px);
}

/* TABLE (UNCHANGED STRUCTURE) */
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 25px;
    font-size: 14px;
}

th {
    background: #f1f3f5;
    padding: 12px;
    text-align: center;
}

td {
    padding: 12px;
    border-bottom: 1px solid #ddd;
    text-align: center;
}

td.left {
    text-align: left;
}

tr:hover {
    background: #f9fafb;
}

/* BADGES */
.badge {
    padding: 5px 10px;
    border-radius: 12px;
    font-size: 12px;
    color: white;
}

.high { background: #dc3545; }
.medium { background: #ffc107; color: black; }
.low { background: #198754; }

.status {
    font-weight: bold;
}

.delete {
    color: #dc3545;
    text-decoration: none;
    font-weight: bold;
}
</style>

<div class="container" style="max-width:950px;">
    <div class="card">

        <!-- HEADER -->
        <div style="display:flex; justify-content:space-between; align-items:center;">
            <h2>Citizen Dashboard</h2>
    <a href="/logout" class="logout-btn">‚èª Logout</a>
</div>
        </div>

        <p style="color:#666; margin-bottom:20px;">
            Submit public service complaints and track their resolution
        </p>

        <!-- RULES SECTION -->
        <div class="info-box">
            <h4>üìå Complaint Rules</h4>
            <ul style="margin:0; padding-left:18px;">
                <li>Enter a meaningful and detailed complaint</li>
                <li>Spam, greetings, or test messages are blocked</li>
                <li>Provide correct location for faster resolution</li>
                <li>One complaint per issue is recommended</li>
            </ul>
        </div>

        <!-- HOW TO USE SECTION -->
        <div class="info-box" style="border-left-color:#198754;">
            <h4 style="color:#198754;">üõ† How to Use</h4>
            <ol style="margin:0; padding-left:18px;">
                <li>Enter the location of the issue</li>
                <li>Describe the problem clearly</li>
                <li>Submit and monitor the status below</li>
            </ol>
        </div>

        <!-- FORM (UNCHANGED) -->
        <form method="post">
            <input
                type="text"
                name="location"
                placeholder="Location (e.g. Area,Mandal,District)"
                required
            >

            <textarea
                name="complaint"
                rows="4"
                placeholder="Describe your complaint clearly..."
                required
            ></textarea>

            <button type="submit">Submit Complaint</button>
        </form>

        <!-- TABLE (UNCHANGED) -->
        <h3 style="margin-top:40px;">My Complaints</h3>

        {% if complaints %}
        <table>
            <tr>
                <th>ID</th>
                <th>Location</th>
                <th>Complaint</th>
                <th>Category</th>
                <th>Priority</th>
                <th>Status</th>
                <th>Action</th>
            </tr>

            {% for c in complaints %}
            <tr>
                <td>{{ c.id }}</td>
                <td>{{ c.location }}</td>
                <td class="left">{{ c.text }}</td>
                <td>{{ c.category }}</td>

                <td>
                    <span class="badge
                        {% if c.priority=='High' %}high
                        {% elif c.priority=='Medium' %}medium
                        {% else %}low{% endif %}">
                        {{ c.priority }}
                    </span>
                </td>

                <td class="status">{{ c.status }}</td>

                <td>
                    <a class="delete"
                       href="/delete_complaint/{{ c.id }}"
                       onclick="return confirm('Delete this complaint?')">
                       Delete
                    </a>
                </td>
            </tr>
            {% endfor %}
        </table>
        {% else %}
            <p style="color:#777;">No complaints submitted yet.</p>
        {% endif %}

    </div>
</div>
{% endblock %}
